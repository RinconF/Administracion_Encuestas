<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Encuestas</title>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div>
            <h1>Sistema de Encuestas</h1>
            <div class="header-subtitle" id="headerSubtitle">Panel de Administraci√≥n</div>
        </div>
        <div class="header-actions">
            <div class="view-toggle">
                <button class="toggle-btn active" data-view="admin" onclick="switchView('admin', event)">Administrador</button>
                <button class="toggle-btn" data-view="user" onclick="switchView('user', event)">Usuario</button>
            </div>
            <button class="btn-primary" id="newSurveyBtn" onclick="openCreateModal()">
                <span>+</span> Nueva Encuesta
            </button>
        </div>
    </div>

    <div id="adminView" class="view-content active">
        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" data-tab="surveys" onclick="switchTab('surveys', event)">
                üìã Mis Encuestas
                <span class="tab-badge" id="surveysCount">0</span>
            </div>
            <div class="tab" data-tab="stats" onclick="switchTab('stats', event)">
                üìä Estad√≠sticas
            </div>
            <div class="tab" data-tab="config" onclick="switchTab('config', event)">
                ‚öôÔ∏è Configuraci√≥n
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Tab: Mis Encuestas -->
            <div id="surveysTab" class="tab-content active">
                <div id="surveysList" class="surveys-grid"></div>
            </div>

            <!-- Tab: Estad√≠sticas -->
            <div id="statsTab" class="tab-content">
                <div id="statsContent"></div>
            </div>

            <!-- Tab: Configuraci√≥n -->
            <div id="configTab" class="tab-content">
                <div class="config-card">
                    <h3>Almacenamiento local</h3>
                    <p style="color: #6b7280;">
                        Las encuestas se guardan autom√°ticamente en tu navegador mediante <code>localStorage</code>. No se realizan
                        peticiones a servidores ni APIs externas.
                    </p>
                    <div id="storageStatus" style="color: #4b5563; margin-top: 1rem;"></div>
                    <div class="config-actions">
                        <button class="btn-sm" onclick="exportData()">‚¨áÔ∏è Exportar datos</button>
                        <button class="btn-sm" onclick="importData()">‚¨ÜÔ∏è Importar datos</button>
                        <button class="btn-sm" onclick="resetData()">‚ôªÔ∏è Restablecer datos de ejemplo</button>
                        <button class="btn-sm" onclick="clearAllData()" style="color: #b91c1c; border-color: #fecaca;">üóëÔ∏è Borrar todo</button>
                    </div>
                </div>
                <div class="config-card">
                    <h3>Validaciones disponibles</h3>
                    <ul id="validationsList" style="list-style: disc; padding-left: 1.25rem; color: #4b5563;"></ul>
                </div>
            </div>
        </div>
    </div>

    <div id="userView" class="view-content">
        <div class="user-container">
            <div id="userLoginCard" class="user-card">
                <h2>Portal de colaboradores</h2>
                <p>Inicia sesi√≥n con tus credenciales corporativas para responder las encuestas pendientes antes de ingresar a la intranet.</p>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="loginEmail">Correo electr√≥nico</label>
                        <input type="email" class="form-input" id="loginEmail" placeholder="nombre@empresa.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="loginPassword">Contrase√±a</label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="btn-primary" style="width: 100%; justify-content: center;">Ingresar</button>
                    <div class="error-message" id="loginError"></div>
                </form>
            </div>

            <div id="userDashboard" style="display: none;">
                <div class="user-card">
                    <div class="user-header">
                        <div>
                            <div class="user-header-title">Hola, <span id="userName"></span></div>
                            <div class="user-meta" id="userPendingInfo"></div>
                        </div>
                        <button type="button" class="btn-sm" onclick="logoutUser()">Cerrar sesi√≥n</button>
                    </div>
                    <p>Por pol√≠ticas internas, debes responder tu encuesta asignada antes de acceder a los recursos de la intranet.</p>
                </div>

                <div class="user-card" id="userSurveySection" style="display: none;">
                    <h2 id="userSurveyTitle"></h2>
                    <p id="userSurveyIntro"></p>
                    <div id="userSurveyContent"></div>
                    <div class="survey-feedback" id="userSurveyFeedback"></div>
                </div>

        <!-- Tab: Configuraci√≥n -->
        <div id="configTab" class="tab-content">
            <div class="config-card">
                <h3>Almacenamiento local</h3>
                <p style="color: #6b7280;">
                    Las encuestas se guardan autom√°ticamente en tu navegador mediante <code>localStorage</code>. No se realizan
                    peticiones a servidores ni APIs externas.
                </p>
                <div id="storageStatus" style="color: #4b5563; margin-top: 1rem;"></div>
                <div class="config-actions">
                    <button class="btn-sm" onclick="exportData()">‚¨áÔ∏è Exportar datos</button>
                    <button class="btn-sm" onclick="importData()">‚¨ÜÔ∏è Importar datos</button>
                    <button class="btn-sm" onclick="resetData()">‚ôªÔ∏è Restablecer datos de ejemplo</button>
                    <button class="btn-sm" onclick="clearAllData()" style="color: #b91c1c; border-color: #fecaca;">üóëÔ∏è Borrar todo</button>
                </div>
            </div>
            <div class="config-card">
                <h3>Validaciones disponibles</h3>
                <ul id="validationsList" style="list-style: disc; padding-left: 1.25rem; color: #4b5563;"></ul>
            </div>
        </div>
    </div>

    <!-- Modal: Crear/Editar Encuesta -->
    <div id="surveyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Nueva Encuesta</h2>
                <button class="btn-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="surveyForm">
                    <div class="form-group">
                        <label class="form-label">T√≠tulo</label>
                        <input type="text" class="form-input" id="surveyTitle" placeholder="Evaluaci√≥n Trimestral Q4" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Tipo de encuesta</label>
                            <select class="form-select" id="surveyType">
                                <option value="opinion">Solo Opini√≥n</option>
                                <option value="quiz">Solo Evaluaci√≥n</option>
                                <option value="mixed">Mixta</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Puntaje m√≠nimo (%)</label>
                            <input type="number" class="form-input" id="minScore" placeholder="70">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Intentos m√°ximos</label>
                            <input type="number" class="form-input" id="maxAttempts" placeholder="3">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Tiempo l√≠mite (minutos)</label>
                        <input type="number" class="form-input" id="timeLimit" placeholder="30">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Preguntas</label>
                        <div id="questionsList"></div>
                        <button type="button" class="btn-add" onclick="addQuestion()">+ Agregar pregunta</button>
                    </div>

                    <div style="display: flex; gap: 0.5rem; margin-top: 2rem;">
                        <button type="submit" class="btn-primary" style="flex: 1;">Guardar Encuesta</button>
                        <button type="button" class="btn-sm" onclick="closeModal()">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
