<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Encuestas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/panel.css">
</head>
<body>
    <div class="header">
        <div>
            <h1>Sistema de Encuestas</h1>
            <div class="header-subtitle" id="headerSubtitle">Panel de Administraci√≥n</div>
        </div>
        <div class="header-actions">
            <div class="view-toggle">
                <button class="toggle-btn active" data-view="admin" onclick="switchView('admin', event)">Administrador</button>
                <button class="toggle-btn" data-view="user" onclick="switchView('user', event)">Usuario</button>
            </div>
            <button class="btn-primary" id="newSurveyBtn" onclick="openCreateModal()">
                <span>+</span> Nueva Encuesta
            </button>
        </div>
    </div>

    <div id="adminView" class="view-content active">
        <div class="tabs">
            <div class="tab active" data-tab="surveys" onclick="switchTab('surveys', event)">
                üìã Mis Encuestas
                <span class="tab-badge" id="surveysCount">0</span>
            </div>
            <div class="tab" data-tab="stats" onclick="switchTab('stats', event)">
                üìä Estad√≠sticas
            </div>
            <div class="tab" data-tab="config" onclick="switchTab('config', event)">
                ‚öôÔ∏è Configuraci√≥n
            </div>
        </div>

        <div class="content">
            <div id="surveysTab" class="tab-content active">
                <div id="surveysList" class="surveys-grid"></div>
            </div>

            <div id="statsTab" class="tab-content">
                <div id="statsContent"></div>
            </div>

            <div id="configTab" class="tab-content">
                <div class="config-card">
                    <h3>Almacenamiento local</h3>
                    <p class="config-description">
                        Las encuestas se guardan autom√°ticamente en tu navegador mediante <code>localStorage</code>. No se realizan
                        peticiones a servidores ni APIs externas.
                    </p>
                    <div id="storageStatus" class="storage-status"></div>
                    <div class="config-actions">
                        <button class="btn-sm" onclick="exportData()">‚¨áÔ∏è Exportar datos</button>
                        <button class="btn-sm" onclick="importData()">‚¨ÜÔ∏è Importar datos</button>
                        <button class="btn-sm" onclick="resetData()">‚ôªÔ∏è Restablecer datos de ejemplo</button>
                        <button class="btn-sm btn-danger" onclick="clearAllData()">üóëÔ∏è Borrar todo</button>
                    </div>
                </div>
                <div class="config-card">
                    <h3>Validaciones disponibles</h3>
                    <ul id="validationsList" class="validations-list"></ul>
                </div>
            </div>
        </div>
    </div>

    <div id="userView" class="view-content">
        <div class="user-container">
            <div id="userLoginCard" class="user-card">
                <h2>Portal de colaboradores</h2>
                <p>Inicia sesi√≥n con tus credenciales corporativas para responder las encuestas pendientes antes de ingresar a la intranet.</p>
                <form id="loginForm" novalidate>
                    <div class="form-group">
                        <label class="form-label" for="loginEmail">Correo electr√≥nico</label>
                        <input type="email" class="form-input" id="loginEmail" placeholder="nombre@empresa.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="loginPassword">Contrase√±a</label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="btn-primary btn-block">Ingresar</button>
                    <div class="error-message" id="loginError" role="alert"></div>
                </form>
            </div>

            <div id="userDashboard" class="user-dashboard" hidden>
                <div class="user-card">
                    <div class="user-header">
                        <div>
                            <div class="user-header-title">Hola, <span id="userName"></span></div>
                            <div class="user-meta" id="userPendingInfo"></div>
                        </div>
                        <button type="button" class="btn-sm" onclick="logoutUser()">Cerrar sesi√≥n</button>
                    </div>
                    <p>Por pol√≠ticas internas, debes responder tu encuesta asignada antes de acceder a los recursos de la intranet.</p>
                </div>

                <div id="userSurveySection" class="user-card" hidden>
                    <h2 id="userSurveyTitle"></h2>
                    <p id="userSurveyIntro"></p>
                    <div id="userSurveyContent" class="user-survey-content"></div>
                    <div class="survey-feedback" id="userSurveyFeedback"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="surveyModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" hidden>
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Nueva Encuesta</h2>
                <button class="btn-close" onclick="closeModal()" aria-label="Cerrar">&times;</button>
            </div>
            <div class="modal-body">
                <form id="surveyForm">
                    <div class="form-group">
                        <label class="form-label" for="surveyTitle">T√≠tulo</label>
                        <input type="text" class="form-input" id="surveyTitle" placeholder="Evaluaci√≥n Trimestral Q4" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="surveyType">Tipo de encuesta</label>
                            <select class="form-select" id="surveyType">
                                <option value="opinion">Solo Opini√≥n</option>
                                <option value="quiz">Solo Evaluaci√≥n</option>
                                <option value="mixed">Mixta</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="minScore">Puntaje m√≠nimo (%)</label>
                            <input type="number" class="form-input" id="minScore" placeholder="70" min="0" max="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="maxAttempts">Intentos m√°ximos</label>
                            <input type="number" class="form-input" id="maxAttempts" placeholder="3" min="1">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="timeLimit">Tiempo l√≠mite (minutos)</label>
                        <input type="number" class="form-input" id="timeLimit" placeholder="30" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Preguntas</label>
                        <div id="questionsList"></div>
                        <button type="button" class="btn-add" onclick="addQuestion()">+ Agregar pregunta</button>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Guardar Encuesta</button>
                        <button type="button" class="btn-sm" onclick="closeModal()">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/panel.js" defer></script>
</body>
</html>
